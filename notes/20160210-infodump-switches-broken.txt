This is happening. I bet it's trying to read hp from Damage.assumeStats on a pokemon in a dead state.


TypeError: Cannot read property 'hp' of undefined
{"self":{"active":{"condition":"207/275","conditions":[],"species":"Ho-Oh","moves":[{"move":"Substitute","id":"substitute","pp":16,"maxpp":16,"target":"self","disabled":true,"accuracy":true,"basePower":0,"category":"Status","name":"Substitute","priority":0,"flags":{"snatch":1,"nonsky":1},"secondary":false,"type":"Normal","volatileStatus":"Substitute"},{"move":"Roost","id":"roost","pp":16,"maxpp":16,"target":"self","disabled":true,"accuracy":true,"basePower":0,"category":"Status","name":"Roost","priority":0,"flags":{"snatch":1,"heal":1},"secondary":false,"type":"Flying"},{"move":"Brave Bird","id":"bravebird","pp":21,"maxpp":24,"target":"any","disabled":false,"accuracy":100,"basePower":120,"category":"Physical","name":"Brave Bird","priority":0,"flags":{"contact":1,"protect":1,"mirror":1,"distance":1},"secondary":false,"type":"Flying","isCrit":false,"bp":120,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":1,"hasSecondaryEffect":false},{"move":"Sacred Fire","id":"sacredfire","pp":8,"maxpp":8,"target":"normal","disabled":false,"accuracy":95,"basePower":100,"category":"Physical","name":"Sacred Fire","priority":0,"flags":{"protect":1,"mirror":1,"defrost":1},"secondary":{"chance":50,"status":"brn"},"type":"Fire","isCrit":false,"bp":100,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":true}],"level":73,"gender":"M","hp":207,"maxhp":275,"hppct":75,"types":["Fire","Flying"],"baseStats":{"hp":106,"atk":130,"def":90,"spa":110,"spd":154,"spe":90},"abilities":{"0":"Pressure","H":"Regenerator"},"baseAbility":"regenerator","stats":{"atk":232,"def":174,"spa":203,"spd":267,"spe":174,"hp":275},"position":"p2a","owner":"p2","item":"leftovers","lastMove":"Brave Bird"},"reserve":[{"condition":"207/275","conditions":[],"species":"Ho-Oh","moves":[{"accuracy":true,"category":"Status","id":"substitute","name":"Substitute","volatileStatus":"Substitute","flags":{"snatch":1,"nonsky":1},"target":"self","type":"Normal","isCrit":false,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false},{"accuracy":true,"category":"Status","id":"roost","name":"Roost","flags":{"snatch":1,"heal":1},"target":"self","type":"Flying","isCrit":false,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false},{"accuracy":100,"basePower":120,"category":"Physical","id":"bravebird","name":"Brave Bird","flags":{"contact":1,"protect":1,"mirror":1,"distance":1},"target":"any","type":"Flying","isCrit":false,"bp":120,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":1,"hasSecondaryEffect":false},{"accuracy":95,"basePower":100,"category":"Physical","id":"sacredfire","name":"Sacred Fire","flags":{"protect":1,"mirror":1,"defrost":1},"target":"normal","type":"Fire","isCrit":false,"bp":100,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false}],"level":73,"gender":"M","hp":207,"maxhp":275,"hppct":75,"types":["Fire","Flying"],"baseStats":{"hp":106,"atk":130,"def":90,"spa":110,"spd":154,"spe":90},"abilities":{"0":"Pressure","H":"Regenerator"},"baseAbility":"regenerator","stats":{"atk":232,"def":174,"spa":203,"spd":267,"spe":174,"hp":275},"position":"p2a","owner":"p2","item":"leftovers","lastMove":"Brave Bird"},{"dead":true,"condition":"0 fnt","conditions":[],"species":"Virizion","moves":[{"accuracy":70,"basePower":120,"category":"Special","id":"focusblast","name":"Focus Blast","flags":{"bullet":1,"protect":1,"mirror":1},"target":"normal","type":"Fighting","isCrit":false,"bp":120,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false},{"accuracy":true,"category":"Status","id":"calmmind","name":"Calm Mind","flags":{"snatch":1},"target":"self","type":"Psychic","isCrit":false,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false},{"accuracy":100,"basePower":75,"category":"Special","id":"gigadrain","name":"Giga Drain","flags":{"protect":1,"mirror":1,"heal":1},"target":"normal","type":"Grass","isCrit":false,"bp":75,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false},{"accuracy":100,"basePower":60,"category":"Special","id":"hiddenpower","name":"Hidden Power Ice","flags":{"protect":1,"mirror":1},"target":"normal","type":"Ice","isCrit":false,"bp":60,"isPulse":false,"isBite":false,"isSpread":false,"hits":1,"ignoresDefenseBoosts":false,"makesContact":false,"hasSecondaryEffect":false}],"level":79,"gender":"M","maxhp":273,"types":["Grass","Fighting"],"baseStats":{"hp":91,"atk":90,"def":72,"spa":90,"spd":129,"spe":108},"abilities":{"0":"Justified"},"baseAbility":"justified","stats":{"atk":187,"def":159,"spa":188,"spd":249,"spe":216,"hp":273},"owner":"p2","item":"leftovers","lastMove":"Hidden Power"},{"condition":"203/203","conditions":[],"species":"Rotom-Heat","moves":[{"accuracy":100,"basePower":60,"category":"Special","id":"hiddenpower","name":"Hidden Power Ice","flags":{"protect":1,"mirror":1},"target":"normal","type":"Ice"},{"accuracy":85,"category":"Status","id":"willowisp","name":"Will-O-Wisp","flags":{"protect":1,"reflectable":1,"mirror":1},"target":"normal","type":"Fire"},{"accuracy":100,"basePower":70,"category":"Special","id":"voltswitch","name":"Volt Switch","flags":{"protect":1,"mirror":1},"target":"normal","type":"Electric"},{"accuracy":90,"basePower":130,"category":"Special","id":"overheat","name":"Overheat","flags":{"protect":1,"mirror":1},"target":"normal","type":"Fire"}],"level":77,"gender":"M","hp":203,"maxhp":203,"hppct":100,"types":["Electric","Fire"],"baseStats":{"hp":50,"atk":65,"def":107,"spa":105,"spd":107,"spe":86},"abilities":{"0":"Levitate"},"baseAbility":"levitate","stats":{"atk":144,"def":209,"spa":207,"spd":209,"spe":177},"owner":"p2","item":"lifeorb"},{"condition":"259/259","conditions":[],"species":"Simisear","moves":[{"accuracy":true,"category":"Status","id":"nastyplot","name":"Nasty Plot","flags":{"snatch":1},"target":"self","type":"Dark"},{"accuracy":85,"basePower":110,"category":"Special","id":"fireblast","name":"Fire Blast","flags":{"protect":1,"mirror":1},"target":"normal","type":"Fire"},{"accuracy":true,"category":"Status","id":"substitute","name":"Substitute","volatileStatus":"Substitute","flags":{"snatch":1,"nonsky":1},"target":"self","type":"Normal"},{"accuracy":70,"basePower":120,"category":"Special","id":"focusblast","name":"Focus Blast","flags":{"bullet":1,"protect":1,"mirror":1},"target":"normal","type":"Fighting"}],"level":83,"gender":"M","hp":259,"maxhp":259,"hppct":100,"types":["Fire"],"baseStats":{"hp":75,"atk":98,"def":63,"spa":98,"spd":63,"spe":101},"abilities":{"0":"Gluttony","H":"Blaze"},"baseAbility":"blaze","stats":{"atk":210,"def":152,"spa":211,"spd":152,"spe":215},"owner":"p2","item":"leftovers","lastMove":"Fire Blast"},{"condition":"318/318","conditions":[],"species":"Lickilicky","moves":[{"accuracy":true,"category":"Status","id":"swordsdance","name":"Swords Dance","flags":{"snatch":1},"target":"self","type":"Normal"},{"accuracy":true,"category":"Status","id":"protect","name":"Protect","volatileStatus":"protect","priority":4,"flags":{},"target":"self","type":"Normal"},{"accuracy":100,"basePower":65,"category":"Physical","id":"knockoff","name":"Knock Off","flags":{"contact":1,"protect":1,"mirror":1},"target":"normal","type":"Dark"},{"accuracy":100,"basePower":85,"category":"Physical","id":"bodyslam","name":"Body Slam","flags":{"contact":1,"protect":1,"mirror":1,"nonsky":1},"target":"normal","type":"Normal"}],"level":83,"gender":"M","hp":318,"maxhp":318,"hppct":100,"types":["Normal"],"baseStats":{"hp":110,"atk":85,"def":95,"spa":80,"spd":95,"spe":50},"abilities":{"0":"Own Tempo","1":"Oblivious","H":"Cloud Nine"},"baseAbility":"cloudnine","stats":{"atk":189,"def":205,"spa":180,"spd":205,"spe":131},"owner":"p2","item":"leftovers"},{"condition":"248/248","conditions":[],"species":"Blastoise","moves":[{"accuracy":100,"basePower":90,"category":"Special","id":"icebeam","name":"Ice Beam","flags":{"protect":1,"mirror":1},"target":"normal","type":"Ice"},{"accuracy":100,"basePower":20,"category":"Physical","id":"rapidspin","name":"Rapid Spin","flags":{"contact":1,"protect":1,"mirror":1},"target":"normal","type":"Normal"},{"accuracy":100,"basePower":80,"category":"Special","id":"scald","name":"Scald","flags":{"protect":1,"mirror":1,"defrost":1},"target":"normal","type":"Water"},{"accuracy":100,"basePower":80,"category":"Special","id":"darkpulse","name":"Dark Pulse","flags":{"protect":1,"pulse":1,"mirror":1,"distance":1},"target":"any","type":"Dark"}],"level":77,"gender":"F","hp":248,"maxhp":248,"hppct":100,"types":["Water"],"baseStats":{"hp":79,"atk":83,"def":100,"spa":85,"spd":105,"spe":78},"abilities":{"0":"Torrent","H":"Rain Dish"},"baseAbility":"torrent","stats":{"atk":172,"def":199,"spa":175,"spd":206,"spe":165},"owner":"p2","item":"blastoisinite"}]},"opponent":{"active":{"condition":"64/100","conditions":[],"species":"Miltank","level":81,"gender":"F","hp":183.68,"maxhp":287,"hppct":64,"types":["Normal"],"baseStats":{"hp":95,"atk":80,"def":105,"spa":40,"spd":70,"spe":100},"abilities":{"0":"Thick Fat","1":"Scrappy","H":"Sap Sipper"},"position":"p1a","owner":"p1","lastMove":"Milk Drink","stats":{"atk":176,"spa":111,"def":217,"spd":160,"spe":209,"hp":287}},"reserve":[{"dead":true,"condition":"0 fnt","conditions":[],"species":"Wormadam-Trash","level":83,"gender":"F","maxhp":100,"types":["Bug","Steel"],"baseStats":{"hp":60,"atk":69,"def":95,"spa":69,"spd":95,"spe":36},"abilities":{"0":"Anticipation","H":"Overcoat"},"owner":"p1"},{"dead":true,"condition":"0 fnt","conditions":[],"species":"Rotom-Mow","level":79,"gender":"M","maxhp":100,"types":["Electric","Grass"],"baseStats":{"hp":50,"atk":65,"def":107,"spa":105,"spd":107,"spe":86},"abilities":{"0":"Levitate"},"owner":"p1"},{"dead":true,"condition":"0 fnt","conditions":[],"species":"Jellicent","level":79,"gender":"M","maxhp":100,"types":["Water","Ghost"],"baseStats":{"hp":100,"atk":60,"def":70,"spa":85,"spd":105,"spe":60},"abilities":{"0":"Water Absorb","1":"Cursed Body","H":"Damp"},"owner":"p1","lastMove":"Taunt"},{"condition":"64/100","conditions":[],"species":"Miltank","level":81,"gender":"F","hp":64,"maxhp":100,"hppct":64,"types":["Normal"],"baseStats":{"hp":95,"atk":80,"def":105,"spa":40,"spd":70,"spe":100},"abilities":{"0":"Thick Fat","1":"Scrappy","H":"Sap Sipper"},"position":"p1a","owner":"p1","lastMove":"Milk Drink"}]},"rqid":18,"turn":14}
